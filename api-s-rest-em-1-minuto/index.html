<!doctype html>
<html lang="en" class="language-javascript">
<head>
    <meta charset="UTF-8">
    <title>APIs REST em 1 minuto - Jaydson Gomes</title>
    <meta name="author" content="Jaydson">
    <meta name="description" content="">

    
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="canonical" href="http://jaydson.org">
    <link rel="stylesheet" href="/css/main.css">
    <link href="/css/vendor/prism.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Condensed' rel='stylesheet' type='text/css'>
    <link href="/favico.ico" rel="icon">
</head>
<body>
<nav class="social">
    <ul class="meni__list">
        <li class="meni__item">
            <a href="/">Home</a>
        </li> 
        <li class="meni__item">
            <a href="https://speakerdeck.com/jaydson">Talks</a>
        </li>
         <li class="meni__item">
            <a class="social__link" href="https://twitter.com/jaydson">
                <svg version="1.1" width="32" height="32" viewBox="0 0 32 32">
    <path d="M32 6.076c-1.177 0.522-2.443 0.875-3.771 1.034 1.355-0.813 2.396-2.099 2.887-3.632-1.269 0.752-2.674 1.299-4.169 1.593-1.198-1.276-2.904-2.073-4.792-2.073-3.626 0-6.565 2.939-6.565 6.565 0 0.515 0.058 1.016 0.17 1.496-5.456-0.274-10.294-2.888-13.532-6.86-0.565 0.97-0.889 2.097-0.889 3.301 0 2.278 1.159 4.287 2.921 5.465-1.076-0.034-2.088-0.329-2.974-0.821-0.001 0.027-0.001 0.055-0.001 0.083 0 3.181 2.263 5.834 5.266 6.437-0.551 0.15-1.131 0.23-1.73 0.23-0.423 0-0.834-0.041-1.235-0.118 0.835 2.608 3.26 4.506 6.133 4.559-2.247 1.761-5.078 2.81-8.154 2.81-0.53 0-1.052-0.031-1.566-0.092 2.905 1.863 6.356 2.95 10.064 2.95 12.076 0 18.679-10.004 18.679-18.68 0-0.285-0.006-0.568-0.019-0.849 1.283-0.926 2.396-2.082 3.276-3.398z" fill="#fff" />
</svg>
            </a>
        </li>
        <li class="meni__item">
            <a class="social__link" href="https://github.com/jaydson">
                <svg version="1.1" width="32" height="32" viewBox="0 0 32 32">
    <path d="M0 17.388c0 1.45 0.136 2.762 0.407 3.935 0.271 1.174 0.647 2.193 1.127 3.059 0.48 0.866 1.090 1.627 1.831 2.285 0.741 0.657 1.544 1.195 2.41 1.612 0.866 0.417 1.854 0.756 2.965 1.017 1.111 0.261 2.245 0.443 3.403 0.548 1.158 0.104 2.431 0.156 3.818 0.156 1.398 0 2.676-0.052 3.834-0.156 1.158-0.104 2.295-0.287 3.411-0.548 1.116-0.261 2.11-0.6 2.981-1.017 0.871-0.417 1.68-0.954 2.425-1.612 0.746-0.657 1.361-1.419 1.846-2.285 0.485-0.866 0.863-1.886 1.134-3.059 0.271-1.174 0.407-2.486 0.407-3.935 0-2.587-0.866-4.825-2.597-6.713 0.094-0.25 0.18-0.535 0.258-0.853 0.078-0.318 0.151-0.772 0.219-1.361 0.068-0.589 0.042-1.27-0.078-2.042-0.12-0.772-0.342-1.56-0.665-2.363l-0.235-0.047c-0.167-0.031-0.441-0.023-0.822 0.024s-0.824 0.141-1.33 0.282c-0.506 0.141-1.158 0.412-1.956 0.814-0.798 0.402-1.64 0.905-2.527 1.51-1.523-0.417-3.615-0.626-6.275-0.626-2.65 0-4.736 0.209-6.259 0.626-0.887-0.605-1.734-1.108-2.543-1.51-0.808-0.402-1.453-0.673-1.933-0.814-0.48-0.141-0.928-0.232-1.346-0.274-0.417-0.042-0.681-0.055-0.79-0.039-0.11 0.016-0.196 0.034-0.258 0.055-0.323 0.803-0.545 1.591-0.665 2.363-0.12 0.772-0.146 1.453-0.078 2.042 0.068 0.589 0.141 1.043 0.219 1.361 0.078 0.318 0.164 0.602 0.258 0.853-1.732 1.888-2.598 4.126-2.598 6.713zM3.928 21.315c0-1.502 0.683-2.879 2.050-4.131 0.407-0.376 0.881-0.66 1.424-0.853 0.542-0.193 1.155-0.302 1.839-0.329 0.683-0.026 1.338-0.021 1.964 0.016 0.626 0.037 1.398 0.086 2.316 0.149 0.918 0.063 1.711 0.094 2.379 0.094 0.668 0 1.46-0.031 2.378-0.094 0.918-0.063 1.69-0.112 2.316-0.149 0.626-0.037 1.28-0.042 1.964-0.016 0.683 0.026 1.296 0.136 1.839 0.329 0.542 0.193 1.017 0.477 1.424 0.853 1.367 1.231 2.050 2.608 2.050 4.131 0 0.897-0.112 1.693-0.337 2.386-0.224 0.694-0.511 1.275-0.861 1.745-0.349 0.469-0.834 0.868-1.455 1.197-0.621 0.329-1.226 0.582-1.815 0.759-0.589 0.177-1.346 0.316-2.269 0.415-0.923 0.099-1.747 0.159-2.472 0.18-0.725 0.021-1.646 0.031-2.762 0.031-1.116 0-2.037-0.010-2.762-0.031-0.725-0.021-1.549-0.081-2.472-0.18-0.923-0.099-1.68-0.237-2.269-0.415-0.589-0.177-1.194-0.43-1.815-0.759-0.621-0.329-1.106-0.728-1.455-1.197-0.349-0.469-0.636-1.051-0.861-1.745-0.224-0.694-0.336-1.489-0.336-2.386zM20 21c0-1.657 0.895-3 2-3s2 1.343 2 3c0 1.657-0.895 3-2 3-1.105 0-2-1.343-2-3zM8 21c0-1.657 0.895-3 2-3s2 1.343 2 3c0 1.657-0.895 3-2 3-1.105 0-2-1.343-2-3z" fill="#fff" />
</svg>
            </a>
        </li>
    </ul>
</nav>
<body>
	<header class="topWrap">
	    <section class="lobby">
	        <h1 class="pageTitle">
	        <a href="">
				APIs REST em 1 minuto
	        </a>
	        </h1>
	        
	        	<time datetime="Wed May 27 2015 18:30:20 GMT-0300 (BRT)">Wed May 27 2015 18:30:20 GMT-0300 (BRT)</time>
	        
	    </section>
	</header>

    <ul class="categories">
    	
    		<li>
    			<a class="categoryTag Node.js" href="/categories/node.js">
    				Node.js
    			</a>
    		</li>
    	
    		<li>
    			<a class="categoryTag  REST" href="/categories/rest">
    				 REST
    			</a>
    		</li>
    	
    		<li>
    			<a class="categoryTag  API" href="/categories/api">
    				 API
    			</a>
    		</li>
    	
    </ul>

	<article class="postContent">
		<p>No último <a href="http://rsjs.org">RSJS</a> tive a oportunidade de assistir a palestra <a href="http://dclucas.github.io/prez-harvesterjs">&quot;Ligthweight APIs with HarvesterJS&quot;</a> do meu ex-professor <a href="https://twitter.com/diogoclucas">Diogo Lucas</a>.<br>Em poucos minutos de palestra eu já consegui identificar várias aplicações que fiz no passado, que poderiam ser totalmente reescritas de uma maneira muito mais simples com o <a href="https://github.com/agco/harvesterjs">HarvesterJS</a>.<br>O HarvesterJS é originalmente um fork do projeto <a href="http://fortunejs.com/">FortuneJS</a>, um framework para criar APIs <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> baseadas na spec <a href="http://jsonapi.org">JSONAPI</a>.  </p>
<p>O objetivo do Harvester foca em manter uma API fiel à JSONAPI spec, com suporte específico ao <a href="http://docs.mongodb.org/">MongoDB</a> (além de resolver alguns problemas de escalabilidade).<br>O projeto está bem ativo e é mantido pelo pessoal da <a href="http://www.agcocorp.com/">AGCO</a>, uma empresa do ramo da agricultura.  </p>
<p>Ok ok, <em>talk is cheap</em>.<br>O título do post é bem sério. É possível criar uma API REST em 1 minuto com o Harvester.<br>Supondo que o seu ambiente já tenha <a href="http://nodejs.org">Node.js</a> e MongoDB, o resto é super fácil, mesmo.<br>Digamos que a sua API precisa expor uma entidade &quot;artist&quot;.<br>Por expor entenda que a API deve disponibilizar métodos <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> para as aplicações.  </p>
<pre><code>// app.js
let harvester = require(&#39;harvesterjs&#39;);

let app = harvester({
    adapter: &#39;mongodb&#39;,
    connectionString: &quot;localhost:27017/mydatabase&quot;
});

app.resource(&#39;artist&#39;, {
    name: String,
    description : String,
})
.listen(1337);
</code></pre><p>Pronto.<br>Basta levantar a aplicação:  </p>
<pre><code>node app.js
</code></pre><p>E agora existe uma API REST completa funcionando.<br>O que é possível fazer?<br>Todas as operações de CRUD via métodos http:  </p>
<h2 id="listar-todos-artistas">Listar todos artistas</h2>
<pre><code>GET     /artists
</code></pre><h2 id="criar-um-novo-artista">Criar um novo artista</h2>
<pre><code>POST     /artists
{
    &quot;name&quot;: &quot;Sepultura&quot;,
    &quot;description&quot;: &quot;Brazilian Metal band&quot;
}
</code></pre><h2 id="pegar-um-artista-pelo-id">Pegar um artista pelo ID</h2>
<pre><code>GET     /artists/555d0bbb37d40da5abc11a86
</code></pre><h2 id="alterar-os-dados-de-um-artista">Alterar os dados de um artista</h2>
<pre><code>PUT     /artists/555d0bbb37d40da5abc11a86
{
    &quot;name&quot;: &quot;Sepultura&quot;,
    &quot;description&quot;: &quot;Best brazilian Metal band ever&quot;
}
</code></pre><h2 id="deletar-um-artista">Deletar um artista</h2>
<pre><code>DELETE     /artists/555d0bbb37d40da5abc11a86
</code></pre><p><br />
Ainda é possível criar relações de maneira bem simples.<br>Digamos que um artista possui referência à outro artista, no caso, 1 para n.<br>Podemos alterar o nosso &quot;resource&quot; de maneira que essa relação seja estabelecida:  </p>
<pre><code>app.resource(&#39;artist&#39;, {
    name: String,
    description : String,
    influences : [&#39;artist&#39;]
})
.listen(1337);
</code></pre><p>Com esta simples alteração nossa API passa a suportar relações:  </p>
<pre><code>GET  /artists/555d5c701eb2d1d033f3b704/influences
</code></pre><p>O retorno desta chamada será baseado nas relações previamente armazenadas, ou seja, se a aplicação disse que determinado artista possui 2 influências, um array de 2 artistas será retornado.  </p>
<h2 id="conclus-o">Conclusão</h2>
<p>Este foi um post introdutório com objetivo de mostrar como é fácil criar APIs REST com o Harvester.<br>Além da facilidade, o código necessário para escrever APIs fica muito fácil de manutenir e evoluir.<br>Eu mesmo reescrevi uma aplicação que tinha certamente mais de 1500 linhas em pouco mais de 10 linhas com o Harvester.  </p>
<p><blockquote class="twitter-tweet" lang="en"><p lang="pt" dir="ltr">Ontem reescrevi em 10 linhas uma aplicação que fiz há um ano atrás com umas 1500. Sério. &lt;3 HarvesterJS //cc <a href="https://twitter.com/diogoclucas">@diogoclucas</a></p>&mdash; Jaydson Gomes (@jaydson) <a href="https://twitter.com/jaydson/status/603541170426290178">May 27, 2015</a></blockquote></p>
<p><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
É isso pessoal, para maiores informações sobre o Harvester, vasculhem o Github do projeto (ainda está com pouca documentação, mas em breve eles devem resolver esse problema).  </p>

	</article>

	<section id="comments" class="comments">
        <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jaydson'; // required: replace example with your forum shortname
        var disqus_url = window.location.href.split('?')[0];
        var disqus_identifier = location.pathname;

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

	<footer class="bottom">
    <div class="licenses">
        <span>
            Blog Proudly powered by <a href="https://github.com/es6rocks/harmonic/">Harmonic</a>
        </span>        
    </div>
</footer>
<script>
var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1264252-8']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<script type="text/javascript" src="/harmonic.js"></script>
<script type="text/javascript" src="/js/main.js"></script>
<script src="/js/vendor/prism.js"></script>
</body>
</html>